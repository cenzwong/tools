<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EV vs Petrol Cost Comparison Tool</title>
    <meta name="description" content="Global EV vs Petrol cost comparison tool. Calculate annual savings, unit conversions, and price equivalency points.">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚡</text></svg>">
    <style>
        :root {
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --ev-color: #10b981;
            --petrol-color: #f59e0b;
            --danger: #ef4444;
            --success: #10b981;
            --border: #e2e8f0;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #0f172a;
                --card-bg: #1e293b;
                --text-main: #f1f5f9;
                --text-muted: #94a3b8;
                --border: #334155;
            }
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.5;
            padding: 2rem 1rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .description { color: var(--text-muted); font-size: 1rem; }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
        }

        .top-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            max-width: 500px;
            margin: 0 auto 2rem;
        }

        @media (max-width: 480px) {
            .top-settings { grid-template-columns: 1fr; }
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .ev-title { color: var(--ev-color); }
        .petrol-title { color: var(--petrol-color); }

        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.4rem;
            color: var(--text-muted);
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        input, select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-color);
            color: var(--text-main);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }

        .unit-label {
            position: absolute;
            right: 1rem;
            font-size: 0.875rem;
            color: var(--text-muted);
            pointer-events: none;
        }

        .results-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Force 50/50 split */
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 600px) {
            .results-container {
                grid-template-columns: 1fr; /* Stack on mobile */
            }
        }

        .res-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .res-highlight {
            background: var(--primary);
            color: white;
            grid-column: 1 / -1; /* Always span across both columns */
            transition: background-color 0.3s ease;
        }

        .res-val {
            display: block;
            font-size: 1.75rem;
            font-weight: 800;
            margin: 0.25rem 0;
        }

        .res-lbl {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        .res-highlight .res-lbl { color: rgba(255,255,255,0.8); }

        .text-success { color: var(--success) !important; }
        .text-danger { color: var(--danger) !important; }

        .equiv-badge {
            display: inline-block;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            background: rgba(0,0,0,0.05);
            color: var(--text-main);
        }
        
        @media (prefers-color-scheme: dark) {
            .equiv-badge { background: rgba(255,255,255,0.05); }
        }

        /* Benchmark Table Styles */
        .benchmark-section {
            margin-top: 3rem;
        }
        
        .table-overflow {
            overflow-x: auto;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--card-bg);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            text-align: left;
        }
        
        th {
            background: var(--bg-color);
            padding: 1rem;
            font-weight: 700;
            color: var(--text-muted);
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
        }
        
        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background: rgba(37, 99, 235, 0.03);
        }

        .actions {
            display: flex;
            justify-content: center;
            margin-top: 1.5rem;
        }

        button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            border: none;
            background: var(--primary);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        button:hover { background: var(--primary-hover); }

        .help-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }

        .help-section h2 { font-size: 1.25rem; margin-bottom: 1rem; }
        .help-section p { color: var(--text-muted); margin-bottom: 1rem; font-size: 0.95rem; }

        .footer {
            text-align: center;
            margin-top: 3rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>⚡ EV vs Petrol Cost Comparison</h1>
        <p class="description">Calculate savings and find the energy price break-even point.</p>
    </header>

    <div class="card">
        <div class="top-settings">
            <div class="form-group">
                <label for="currency">Currency</label>
                <select id="currency">
                    <option value="£">GBP (£)</option>
                    <option value="$">USD ($)</option>
                    <option value="€">EUR (€)</option>
                    <option value="A$">AUD (A$)</option>
                    <option value="C$">CAD (C$)</option>
                    <option value="¥">JPY (¥)</option>
                    <option value="₹">INR (₹)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="distance">Annual Distance</label>
                <div class="input-wrapper">
                    <input type="number" id="distance" value="10000" min="1" step="500">
                    <span class="unit-label">miles</span>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- EV Section -->
            <section>
                <div class="section-title ev-title">
                    <span>Electric Vehicle</span>
                </div>
                <div class="form-group">
                    <label for="elecPrice">Electricity Price</label>
                    <div class="input-wrapper">
                        <input type="number" id="elecPrice" value="0.27" step="0.01" min="0">
                        <span class="unit-label cur-sym">£</span><span class="unit-label" style="right: 2.2rem;">/kWh</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="evEfficiencyMi">Efficiency (Distance-based)</label>
                    <div class="input-wrapper">
                        <input type="number" id="evEfficiencyMi" value="3.5" step="0.1" min="0.1">
                        <span class="unit-label">mi/kWh</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="evEfficiencyKwh">Efficiency (Energy-based)</label>
                    <div class="input-wrapper">
                        <input type="number" id="evEfficiencyKwh" value="17.7" step="0.1" min="1">
                        <span class="unit-label">kWh/100km</span>
                    </div>
                </div>
            </section>

            <!-- Petrol Section -->
            <section>
                <div class="section-title petrol-title">
                    <span>Petrol / ICE</span>
                </div>
                <div class="form-group">
                    <label for="fuelPrice">Fuel Price</label>
                    <div class="input-wrapper">
                        <input type="number" id="fuelPrice" value="1.45" step="0.01" min="0">
                        <span class="unit-label cur-sym">£</span><span class="unit-label" style="right: 2.2rem;">/Litre</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="fuelMpg">Fuel Economy (MPG)</label>
                    <div class="input-wrapper">
                        <input type="number" id="fuelMpg" value="45" step="0.5" min="1">
                        <span class="unit-label">MPG</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="fuelL100">Fuel Economy (L/100km)</label>
                    <div class="input-wrapper">
                        <input type="number" id="fuelL100" value="6.3" step="0.1" min="0.1">
                        <span class="unit-label">L/100km</span>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="results-container">
        <div class="res-card res-highlight" id="savingsCard">
            <span class="res-lbl">Annual Savings</span>
            <span class="res-val" id="resSaving">£0.00</span>
            <span id="savingsSubtext" style="font-size: 0.85rem; font-weight: 500;">EV is cheaper than Petrol</span>
        </div>
        <div class="res-card">
            <span class="res-lbl">Annual EV Cost</span>
            <span class="res-val" id="resEvYear">£0.00</span>
            <div class="equiv-badge" id="equivFuel">Equiv. Petrol: £0.00/L</div>
        </div>
        <div class="res-card">
            <span class="res-lbl">Annual Petrol Cost</span>
            <span class="res-val" id="resIceYear">£0.00</span>
            <div class="equiv-badge" id="equivElec">Equiv. Elec: £0.00/kWh</div>
        </div>
    </div>

    <div class="actions">
        <button id="copyBtn">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
            Copy Shareable Link
        </button>
    </div>

    <!-- Vehicle Benchmarks Table -->
    <div class="benchmark-section">
        <h2 style="font-size: 1.25rem; margin-bottom: 1rem;">Common Vehicle Benchmarks</h2>
        <div class="table-overflow">
            <table>
                <thead>
                    <tr>
                        <th>Vehicle Model</th>
                        <th>Type</th>
                        <th>MPG (Comb)</th>
                        <th>L/100km</th>
                        <th>EV Efficiency</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Tesla Model 3 (Long Range)</td>
                        <td>EV</td>
                        <td>~132 MPGe</td>
                        <td>-</td>
                        <td>5.4 mi/kWh (13.6 kWh/100km)</td>
                    </tr>
                    <tr>
                        <td>Tesla Model 3 (Standard)</td>
                        <td>EV</td>
                        <td>~130 MPGe</td>
                        <td>-</td>
                        <td>4.8 mi/kWh (13.0 kWh/100km)</td>
                    </tr>
                    <tr>
                        <td>Tesla Model Y (Long Range)</td>
                        <td>EV</td>
                        <td>~122 MPGe</td>
                        <td>-</td>
                        <td>4.0 mi/kWh (14.2 kWh/100km)</td>
                    </tr>
                    <tr>
                        <td>Kia EV3 (81.4 kWh)</td>
                        <td>EV</td>
                        <td>~120 MPGe</td>
                        <td>-</td>
                        <td>4.6 mi/kWh (13.5 kWh/100km)</td>
                    </tr>
                    <tr>
                        <td>Toyota Prius (2025)</td>
                        <td>HEV</td>
                        <td>57 MPG</td>
                        <td>4.1 L</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Toyota Yaris Hybrid (1.5L)</td>
                        <td>HEV</td>
                        <td>71 MPG</td>
                        <td>3.3 L</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Toyota C-HR PHEV (2.0L)</td>
                        <td>PHEV</td>
                        <td>~314 MPG*</td>
                        <td>0.9 L*</td>
                        <td>4.4 mi/kWh (14.0 kWh/100km)</td>
                    </tr>
                    <tr>
                        <td>Toyota C-HR Hybrid (1.8L)</td>
                        <td>HEV</td>
                        <td>59 MPG</td>
                        <td>4.0 L</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Kia Niro Hybrid</td>
                        <td>HEV</td>
                        <td>53 MPG</td>
                        <td>4.4 L</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>Hyundai Elantra Hybrid</td>
                        <td>HEV</td>
                        <td>54 MPG</td>
                        <td>4.3 L</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">*PHEV figures assume starting with a full battery. Real-world performance varies based on driving habits.</p>
    </div>

    <div class="help-section">
        <h2>How it works</h2>
        <p><strong>Equivalency:</strong> The "Equiv. Elec" value tells you how much you would need to pay per kWh for an EV to cost exactly the same as your petrol car. For example, if it says "£0.50/kWh", that's your break-even point.</p>
        <p><strong>Calculations:</strong> We assume UK Imperial Gallons (4.546L) for MPG. If you are in the US, please note this may slightly overestimate MPG economy compared to US Gallons.</p>
        <p><strong>Units:</strong> Updates to distance-based efficiency (MPG or mi/kWh) will automatically recalculate the corresponding volumetric efficiency (L/100km or kWh/100km).</p>
    </div>

    <div class="footer">
        Private & Local. No data leaves your browser.
    </div>
</div>

<script>
(function() {
    const MI_TO_KM = 1.60934;
    const IMP_GAL_TO_L = 4.54609;
    
    const inputs = {
        currency: document.getElementById('currency'),
        distance: document.getElementById('distance'),
        elecPrice: document.getElementById('elecPrice'),
        evEffMi: document.getElementById('evEfficiencyMi'),
        evEffKwh: document.getElementById('evEfficiencyKwh'),
        fuelPrice: document.getElementById('fuelPrice'),
        fuelMpg: document.getElementById('fuelMpg'),
        fuelL100: document.getElementById('fuelL100')
    };

    const outputs = {
        evYear: document.getElementById('resEvYear'),
        iceYear: document.getElementById('resIceYear'),
        saving: document.getElementById('resSaving'),
        savingsSubtext: document.getElementById('savingsSubtext'),
        savingsCard: document.getElementById('savingsCard'),
        equivFuel: document.getElementById('equivFuel'),
        equivElec: document.getElementById('equivElec')
    };

    function updateLogic(triggerId) {
        if (triggerId === 'currency') {
            document.querySelectorAll('.cur-sym').forEach(el => el.textContent = inputs.currency.value);
        } else if (triggerId === 'fuelMpg') {
            const mpg = parseFloat(inputs.fuelMpg.value);
            if (mpg > 0) inputs.fuelL100.value = (282.481 / mpg).toFixed(1);
        } else if (triggerId === 'fuelL100') {
            const l100 = parseFloat(inputs.fuelL100.value);
            if (l100 > 0) inputs.fuelMpg.value = (282.481 / l100).toFixed(1);
        } else if (triggerId === 'evEfficiencyMi') {
            const miKwh = parseFloat(inputs.evEffMi.value);
            if (miKwh > 0) inputs.evEffKwh.value = (100 / (miKwh * MI_TO_KM)).toFixed(1);
        } else if (triggerId === 'evEfficiencyKwh') {
            const kwh100 = parseFloat(inputs.evEffKwh.value);
            if (kwh100 > 0) inputs.evEffMi.value = (100 / (kwh100 * MI_TO_KM)).toFixed(2);
        }

        calculate();
    }

    function calculate() {
        const dist = parseFloat(inputs.distance.value) || 0;
        const cur = inputs.currency.value;
        
        // EV Math
        const evMiKwh = parseFloat(inputs.evEffMi.value) || 1;
        const ePrice = parseFloat(inputs.elecPrice.value) || 0;
        const annualEv = (dist / evMiKwh) * ePrice;

        // Petrol Math
        const mpg = parseFloat(inputs.fuelMpg.value) || 1;
        const fPrice = parseFloat(inputs.fuelPrice.value) || 0;
        const annualIce = (dist / mpg) * IMP_GAL_TO_L * fPrice;

        const diff = annualIce - annualEv;
        const cheaperBy = Math.abs(diff);

        // Format
        const fmt = (val) => cur + val.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});

        outputs.evYear.textContent = fmt(annualEv);
        outputs.iceYear.textContent = fmt(annualIce);
        outputs.saving.textContent = (diff >= 0 ? "" : "-") + fmt(cheaperBy);

        // Styling results
        if (diff > 0) {
            // EV is cheaper (Green)
            outputs.evYear.className = "res-val text-success";
            outputs.iceYear.className = "res-val text-danger";
            outputs.savingsCard.style.backgroundColor = 'var(--ev-color)';
            const percent = ((cheaperBy / annualIce) * 100).toFixed(0);
            outputs.savingsSubtext.textContent = `EV is ${percent}% cheaper than Petrol`;
        } else if (diff < 0) {
            // Petrol is cheaper (Orange)
            outputs.evYear.className = "res-val text-danger";
            outputs.iceYear.className = "res-val text-success";
            outputs.savingsCard.style.backgroundColor = 'var(--petrol-color)';
            const percent = ((cheaperBy / annualEv) * 100).toFixed(0);
            outputs.savingsSubtext.textContent = `Petrol is ${percent}% cheaper than EV`;
        } else {
            // Equal (Blue)
            outputs.evYear.className = "res-val";
            outputs.iceYear.className = "res-val";
            outputs.savingsCard.style.backgroundColor = 'var(--primary)';
            outputs.savingsSubtext.textContent = "Costs are identical";
        }

        // Equivalency Logic
        const fuelEquiv = annualEv / ((dist / mpg) * IMP_GAL_TO_L);
        outputs.equivFuel.textContent = `Break-even Fuel: ${cur}${fuelEquiv.toFixed(2)}/L`;

        const elecEquiv = annualIce / (dist / evMiKwh);
        outputs.equivElec.textContent = `Break-even Elec: ${cur}${elecEquiv.toFixed(2)}/kWh`;
    }

    Object.keys(inputs).forEach(key => {
        inputs[key].addEventListener('input', (e) => updateLogic(e.target.id));
    });

    document.getElementById('copyBtn').addEventListener('click', () => {
        // Construct human-readable query parameters
        const params = new URLSearchParams();
        Object.keys(inputs).forEach(k => params.append(k, inputs[k].value));
        
        const url = window.location.origin + window.location.pathname + '?' + params.toString();
        
        const dummy = document.createElement('input');
        document.body.appendChild(dummy);
        dummy.value = url;
        dummy.select();
        document.execCommand('copy');
        document.body.removeChild(dummy);

        const btn = document.getElementById('copyBtn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '✅ Link Copied!';
        setTimeout(() => btn.innerHTML = originalText, 2000);
    });

    window.onload = () => {
        const params = new URLSearchParams(window.location.search);
        
        // Restore from individual readable parameters
        Object.keys(inputs).forEach(k => {
            const val = params.get(k);
            if (val !== null && inputs[k]) {
                inputs[k].value = val;
            }
        });
        
        // Backwards compatibility check for the old 's' parameter
        const stateStr = params.get('s');
        if (stateStr) {
            try {
                const state = JSON.parse(atob(stateStr));
                Object.keys(state).forEach(k => {
                    if (inputs[k]) inputs[k].value = state[k];
                });
            } catch(e) { console.error(e); }
        }

        updateLogic('currency');
        calculate();
    };

})();
</script>
</body>
</html>